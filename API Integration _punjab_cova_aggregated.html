<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
  <link rel="stylesheet" href="/resources/demos/style.css">
  <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <style>
        .custom{
            margin-top:50px;
            width:100%;
            padding:10px;
        }
        .custom-table{
            width:75%;
            font-size:16px;
            margin:auto;
            text-align:center;
        }
        .custom-drop{
            text-align:center;
        }
    </style>
    <style>
        thead>tr>td {
            font-weight: bold;
        }
        tbody>tr>td {
            font-weight: bold;
        }

        input[type=number]::-webkit-inner-spin-button,
        input[type=number]::-webkit-outer-spin-button {
            opacity: 1;
        }

        /* Center the loader  */
        #loader {
            position: absolute;
            left: 50%;
            top: 50%;
            z-index: 1;
            width: 150px;
            height: 150px;
            margin: -75px 0 0 -75px;
            border: 16px solid #f3f3f3;
            border-radius: 50%;
            border-top: 16px solid #34B4DB;
            width: 120px;
            height: 120px;
            -webkit-animation: spin 2s linear infinite;
            animation: spin 2s linear infinite;
        }

        @-webkit-keyframes spin {
            0% {
                -webkit-transform: rotate(0deg);
            }
            100% {
                -webkit-transform: rotate(360deg);
            }
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }
        /* Add animation to "page content" */

        .animate-bottom {
            position: relative;
            -webkit-animation-name: animatebottom;
            -webkit-animation-duration: 1s;
            animation-name: animatebottom;
            animation-duration: 1s
        }

        @-webkit-keyframes animatebottom {
            from {
                bottom: -100px;
                opacity: 0
            }
            to {
                bottom: 0px;
                opacity: 1
            }
        }

        @keyframes animatebottom {
            from {
                bottom: -100px;
                opacity: 0
            }
            to {
                bottom: 0;
                opacity: 1
            }
        }

        #printing {

            text-align: center;
        }
    </style>
</head>
<body>
<div class="container-fluid">
    <div class="row">
        <div  id="importButton">
            <br>
			<label for="importDateLabel">Import Date:</label>
			<input type="text" id="importDate" name="importDate"  style="margin-left: 1%">
            <button onClick="readAPI()" disabled id="Import" style="margin-left: 5%">Start Importing Data</button>

        </div>

        <div id="resultDiv">
            <h4 id ="importMsg"></h4>
        </div>

        <!--<div id="loader"> <h4 id = "templateProgress"></h4></div>-->

    </div>
    <br><br>
    <div id="loader"></div>
</div>
</body>
  <script>
  $( function() {
    $( "#importDate" ).datepicker();
  } );
  </script>
<script type="text/javascript">
    var finalOu = [];
    var orgUnitMap = [];
    var dataElementMap = [];
    var impCount = "";
    var upCount = "";
    var igCount = "";
    var conflictsDetails = [];
    var regOrgUnitList = [];
    var regPeriodList = [];
    var dataSetUid = 'hxC8LQlCua5';
    var cdsr = { completeDataSetRegistrations: [] };
    var dataSetCompleteRegistration = "";
    $(document).ready(function(){
    document.getElementById("loader").style.display = "none";


	loadOrgUnits();
	console.log( finalOu );
	document.getElementById("Import").disabled = false;
	//document.getElementById('importButton').style.display = 'block';
	document.getElementById('resultDiv').style.display = 'none';

	//console.log( dataElementsMapping );

    });

    function readAPI() {
        //document.getElementById("loader").fadeIn();
        //document.getElementById("templateProgress").html(" -> preparing data values to import");
		
		 if( document.getElementById("importDate").value === ""){
            return alert("Please Select Date");
        }
		else{
		
			var tempSelectedPeriod = document.getElementById("importDate").value;
			document.getElementById("Import").disabled = true;
			document.getElementById('importButton').style.display = 'none';
			document.getElementById('resultDiv').style.display = 'block';
			var strMsg = " Import Start.... ";
			var resultMsg = strMsg.bold();
			document.getElementById("importMsg").innerHTML = " Import Start.... for date -- " + tempSelectedPeriod.split("/")[2]+ "-" + tempSelectedPeriod.split("/")[0]+ "-" + tempSelectedPeriod.split("/")[1];
			/*
			showLoader();
			lockScreen();
			setTimeout(function(){ startImporting() }, 0);
			*/
			$('#loader').show();
			setTimeout(function () {
				startImporting();
			}, 1000);
		}	

    }


    //res.setHeader('Access-Control-Allow-Origin', '*');
    function startImporting() {

        /*
        document.getElementById("Import").disabled = true;
        document.getElementById('importButton').style.display = 'none';
        document.getElementById('resultDiv').style.display = 'block';
        document.getElementById("importMsg").textContent = " Import Start ";
        */


    //lockScreen();
	var dataElementsMapping = [
		{
			"dhis_name": "Samples Collected",
			"name": "sample_RTPCR_govt",
			"id": "j9zd5z2tjYL",
			"categorycombo": "vZEBy0joAB8"
		},
		{
			"dhis_name": "Samples Collected",
			"name": "sample_RTPCR_private",
			"id": "j9zd5z2tjYL",
			"categorycombo": "wafvmYdVjpZ"
		},
		{
			"dhis_name": "Samples Collected",
			"name": "sample_rapid_antigen_test_govt",
			"id": "j9zd5z2tjYL",
			"categorycombo": "nh0UO7Eabh1"
		},
		{
			"dhis_name": "Samples Collected",
			"name": "sample_rapid_antigen_test_private",
			"id": "j9zd5z2tjYL",
			"categorycombo": "LUMUf1TmrDf"
		},
		{
			"dhis_name": "Samples Collected",
			"name": "sample_trunat_cbnat_govt",
			"id": "j9zd5z2tjYL",
			"categorycombo": "NqvMPfmgrk9"
		},
		{
			"dhis_name": "Samples Collected",
			"name": "sample_trunat_cbnat_private",
			"id": "j9zd5z2tjYL",
			"categorycombo": "zVkPdzaE3di"
		},
		{
			"dhis_name": "Samples Tested",
			"name": "tested_RTPCR_govt",
			"id": "HpdCtyEdMJ7",
			"categorycombo": "vZEBy0joAB8"
		},
		{
			"dhis_name": "Samples Tested",
			"name": "tested_RTPCR_private",
			"id": "HpdCtyEdMJ7",
			"categorycombo": "wafvmYdVjpZ"
		},
		{
			"dhis_name": "Samples Tested",
			"name": "tested_antigen_test_govt",
			"id": "HpdCtyEdMJ7",
			"categorycombo": "nh0UO7Eabh1"
		},
		{
			"dhis_name": "Samples Tested",
			"name": "tested_antigen_test_private",
			"id": "HpdCtyEdMJ7",
			"categorycombo": "LUMUf1TmrDf"
		},
		{
			"dhis_name": "Samples Tested",
			"name": "tested_trunat_cbnat_govt",
			"id": "HpdCtyEdMJ7",
			"categorycombo": "NqvMPfmgrk9"
		},
		{
			"dhis_name": "Samples Tested",
			"name": "tested_trunat_cbnat_private",
			"id": "HpdCtyEdMJ7",
			"categorycombo": "zVkPdzaE3di"
		},
		{
			"dhis_name": "Samples Positive",
			"name": "positive_RTPCR_govt",
			"id": "e4RTlLbj5CU",
			"categorycombo": "vZEBy0joAB8"
		},
		{
			"dhis_name": "Samples Positive",
			"name": "positive_RTPCR_private",
			"id": "e4RTlLbj5CU",
			"categorycombo": "wafvmYdVjpZ"
		},
		{
			"dhis_name": "Samples Positive",
			"name": "positive_antigen_test_govt",
			"id": "e4RTlLbj5CU",
			"categorycombo": "nh0UO7Eabh1"
		},
		{
			"dhis_name": "Samples Positive",
			"name": "positive_antigen_test_private",
			"id": "e4RTlLbj5CU",
			"categorycombo": "LUMUf1TmrDf"
		},
		{
			"dhis_name": "Samples Positive",
			"name": "positive_trunat_cbnat_govt",
			"id": "e4RTlLbj5CU",
			"categorycombo": "NqvMPfmgrk9"
		},
		{
			"dhis_name": "Samples Positive",
			"name": "positive_trunat_cbnat_private",
			"id": "e4RTlLbj5CU",
			"categorycombo": "zVkPdzaE3di"
		}		
		
	];










	var selectedPeriod = document.getElementById("importDate").value;
	//alert( selectedPeriod );
    var dataValues = [];
	var currentDate = new Date();
	var currentYear = currentDate.getFullYear();
	var nextYear = currentDate.getFullYear() + 1;
	var currentFinancialYear = currentYear + "-" + nextYear;
	console.log( "currentFinancialYear -- " + currentFinancialYear );
    var proxyURL = "https://cors-anywhere.herokuapp.com/";
	//var todayDate = '2021-01-27';
	var tempImportDate = selectedPeriod.split("/")[2]+ "-" + selectedPeriod.split("/")[0]+ "-" + selectedPeriod.split("/")[1];
	//alert( tempImportDate );
	var isoPeriod = selectedPeriod.split("/")[2] + selectedPeriod.split("/")[0] + selectedPeriod.split("/")[1];
	//alert( tempImportDate + " - " + isoPeriod );
	for (var j = 0; j < finalOu.length; j++) {
	
		var postDataJson = {
			"punjab_lgd_district_Id": finalOu[j].code,
			"search_type": "D",
			"start_date1": tempImportDate,
			"dist_date": tempImportDate,
			"type_of_area": ""
		}
		$.ajax({

			url: 'https://cova.punjab.gov.in/api/cova/hospital/services/v1/fetch-health-sampling-testing-positive-data-all',
			async: false,
			type: 'POST',
			crossDomain: true,
			contentType: 'application/json',
			headers: {
				'Authorization': 'Bearer eyJhbGciOiJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGRzaWctbW9yZSNobWFjLXNoYTI1NiIsInR5cCI6IkpXVCJ9.eyJ1aWQiOiI0NiIsInVzZXJ0eXBlIjoiMSIsInRzIjoiNDQ0IiwiZXhwIjoxNjI1OTg3MjAyLCJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjYzODg0IiwiYXVkIjoiaHR0cDovL2xvY2FsaG9zdDo2Mzg4NCJ9.Hz8C5U-yW2guwMYegISGtUPQ0OEcdpNxFwcOgOSvWh0'
			},
			data: JSON.stringify(postDataJson),
			
			success: function ( apiResponse )
			{
				//console.log( j + " -- " + finalOu[j].name + "  code -- " + finalOu[j].code + " Api Response --  " + apiResponse.sys_message + "  data -- " + apiResponse.data  );
				if( apiResponse.response != 0 && apiResponse.data != null ){
					console.log( " Api Response length --  " + apiResponse.data.length );
					console.log( apiResponse );
					for (var i = 0; i < apiResponse.data.length; i++) {
						
						/*
						console.log( " Api Response --" +  apiResponse.data[i].ROWNUM  + " - "  +  apiResponse.data[i].district_name  + " - " + apiResponse.data[i].positive_RTPCR_govt + " - " + 
						apiResponse.data[i].punjab_lgd_district_Id + " - " + apiResponse.data[i].positive_RTPCR_private  + " - " + 
						apiResponse.data[i].sample_RTPCR_private + " - " + apiResponse.data[i].sample_RTPCR_govt  + " - " + 
						apiResponse.data[i].positive_antigen_test_govt + " - " + apiResponse.data[i].positive_antigen_test_private  + " - " + 
						apiResponse.data[i].positive_trunat_cbnat_govt + " - " + apiResponse.data[i].positive_trunat_cbnat_private  + " - " + 
						apiResponse.data[i].sample_rapid_antigen_test_govt + " - " + apiResponse.data[i].sample_rapid_antigen_test_private  + " - " +  
						apiResponse.data[i].sample_trunat_cbnat_govt + " - " + apiResponse.data[i].sample_trunat_cbnat_private  + " - " +  
						apiResponse.data[i].tested_RTPCR_govt + " - " + apiResponse.data[i].tested_RTPCR_private  + " - " + 
						apiResponse.data[i].tested_trunat_cbnat_govt + " - " + apiResponse.data[i].tested_trunat_cbnat_private  + " - " + 
						apiResponse.data[i].tested_antigen_test_govt + " - " + apiResponse.data[i].tested_antigen_test_private );
						*/
						
						for (var k = 0; k < dataElementsMapping.length; k++) {
						  var dataValue = {};

						  if(dataElementsMapping[k].name === "sample_RTPCR_govt" )
						  {
							  dataValue.period = isoPeriod;
							  dataValue.dataElement = dataElementsMapping[k].id;
							  dataValue.categoryOptionCombo = dataElementsMapping[k].categorycombo;
							  dataValue.orgUnit = finalOu[j].id;
							  dataValue.value = apiResponse.data[i].sample_RTPCR_govt;
							  dataValues.push(dataValue);
						  }
						  else if(dataElementsMapping[k].name === "sample_RTPCR_private" )
						  {
							  dataValue.period = isoPeriod;
							  dataValue.dataElement = dataElementsMapping[k].id;
							  dataValue.categoryOptionCombo = dataElementsMapping[k].categorycombo;
							  dataValue.orgUnit = finalOu[j].id;
							  dataValue.value = apiResponse.data[i].sample_RTPCR_private;
							  dataValues.push(dataValue);
						  }
						  else if(dataElementsMapping[k].name === "sample_rapid_antigen_test_govt" )
						  {
							  dataValue.period = isoPeriod;
							  dataValue.dataElement = dataElementsMapping[k].id;
							  dataValue.categoryOptionCombo = dataElementsMapping[k].categorycombo;
							  dataValue.orgUnit = finalOu[j].id;
							  dataValue.value = apiResponse.data[i].sample_rapid_antigen_test_govt;
							  dataValues.push(dataValue);
						  }						 
						  else if(dataElementsMapping[k].name === "sample_rapid_antigen_test_private" )
						  {
							   dataValue.period = isoPeriod;
							  dataValue.dataElement = dataElementsMapping[k].id;
							  dataValue.categoryOptionCombo = dataElementsMapping[k].categorycombo;
							  dataValue.orgUnit = finalOu[j].id;
							  dataValue.value = apiResponse.data[i].sample_rapid_antigen_test_private;
							  dataValues.push(dataValue);
						  }
						  else if( dataElementsMapping[k].name === "sample_trunat_cbnat_govt" )
						  {
						      dataValue.period = isoPeriod;
							  dataValue.dataElement = dataElementsMapping[k].id;
							  dataValue.categoryOptionCombo = dataElementsMapping[k].categorycombo;
							  dataValue.orgUnit = finalOu[j].id;
							  dataValue.value = apiResponse.data[i].sample_trunat_cbnat_govt;
							  dataValues.push(dataValue);
						  }
						  else if(dataElementsMapping[k].name === "sample_trunat_cbnat_private" )
						  {
							  dataValue.period = isoPeriod;
							  dataValue.dataElement = dataElementsMapping[k].id;
							  dataValue.categoryOptionCombo = dataElementsMapping[k].categorycombo;
							  dataValue.orgUnit = finalOu[j].id;
							  dataValue.value = apiResponse.data[i].sample_trunat_cbnat_private;
							  dataValues.push(dataValue);
						  }						 						  
						  else if(dataElementsMapping[k].name === "tested_RTPCR_govt" )
						  {
							  dataValue.period = isoPeriod;
							  dataValue.dataElement = dataElementsMapping[k].id;
							  dataValue.categoryOptionCombo = dataElementsMapping[k].categorycombo;
							  dataValue.orgUnit = finalOu[j].id;
							  dataValue.value = apiResponse.data[i].tested_RTPCR_govt;
							  dataValues.push(dataValue);
						  }
						  else if(dataElementsMapping[k].name === "tested_RTPCR_private" )
						  {
							  dataValue.period = isoPeriod;
							  dataValue.dataElement = dataElementsMapping[k].id;
							  dataValue.categoryOptionCombo = dataElementsMapping[k].categorycombo;
							  dataValue.orgUnit = finalOu[j].id;
							  dataValue.value = apiResponse.data[i].tested_RTPCR_private;
							  dataValues.push(dataValue);
						  }
						  else if(dataElementsMapping[k].name === "tested_antigen_test_govt" )
						  {
							  dataValue.period = isoPeriod;
							  dataValue.dataElement = dataElementsMapping[k].id;
							  dataValue.categoryOptionCombo = dataElementsMapping[k].categorycombo;
							  dataValue.orgUnit = finalOu[j].id;
							  dataValue.value = apiResponse.data[i].tested_antigen_test_govt;
							  dataValues.push(dataValue);
						  }						 
						  else if(dataElementsMapping[k].name === "tested_antigen_test_private" )
						  {
                              dataValue.period = isoPeriod;
							  dataValue.dataElement = dataElementsMapping[k].id;
							  dataValue.categoryOptionCombo = dataElementsMapping[k].categorycombo;
							  dataValue.orgUnit = finalOu[j].id;
							  dataValue.value = apiResponse.data[i].tested_antigen_test_private;
							  dataValues.push(dataValue);
						  }
						  else if( dataElementsMapping[k].name === "tested_trunat_cbnat_govt" )
						  {
						      dataValue.period = isoPeriod;
							  dataValue.dataElement = dataElementsMapping[k].id;
							  dataValue.categoryOptionCombo = dataElementsMapping[k].categorycombo;
							  dataValue.orgUnit = finalOu[j].id;
							  dataValue.value = apiResponse.data[i].tested_trunat_cbnat_govt;
							  dataValues.push(dataValue);
						  }
						  else if(dataElementsMapping[k].name === "tested_trunat_cbnat_private" )
						  {
							  dataValue.period = isoPeriod;
							  dataValue.dataElement = dataElementsMapping[k].id;
							  dataValue.categoryOptionCombo = dataElementsMapping[k].categorycombo;
							  dataValue.orgUnit = finalOu[j].id;
							  dataValue.value = apiResponse.data[i].tested_trunat_cbnat_private;
							  dataValues.push(dataValue);
						  }						  
						  else if(dataElementsMapping[k].name === "positive_RTPCR_govt" )
						  {
							  dataValue.period = isoPeriod;
							  dataValue.dataElement = dataElementsMapping[k].id;
							  dataValue.categoryOptionCombo = dataElementsMapping[k].categorycombo;
							  dataValue.orgUnit = finalOu[j].id;
							  dataValue.value = apiResponse.data[i].positive_RTPCR_govt;
							  dataValues.push(dataValue);
						  }
						  else if(dataElementsMapping[k].name === "positive_RTPCR_private" )
						  {
							  dataValue.period = isoPeriod;
							  dataValue.dataElement = dataElementsMapping[k].id;
							  dataValue.categoryOptionCombo = dataElementsMapping[k].categorycombo;
							  dataValue.orgUnit = finalOu[j].id;
							  dataValue.value = apiResponse.data[i].positive_RTPCR_private;
							  dataValues.push(dataValue);
						  }
						  else if(dataElementsMapping[k].name === "positive_antigen_test_govt" )
						  {
							  dataValue.period = isoPeriod;
							  dataValue.dataElement = dataElementsMapping[k].id;
							  dataValue.categoryOptionCombo = dataElementsMapping[k].categorycombo;
							  dataValue.orgUnit = finalOu[j].id;
							  dataValue.value = apiResponse.data[i].positive_antigen_test_govt;
							  dataValues.push(dataValue);
						  }						 
						  else if(dataElementsMapping[k].name === "positive_antigen_test_private" )
						  {
							   dataValue.period = isoPeriod;
							  dataValue.dataElement = dataElementsMapping[k].id;
							  dataValue.categoryOptionCombo = dataElementsMapping[k].categorycombo;
							  dataValue.orgUnit = finalOu[j].id;
							  dataValue.value = apiResponse.data[i].positive_antigen_test_private;
							  dataValues.push(dataValue);
						  }
						  else if( dataElementsMapping[k].name === "positive_trunat_cbnat_govt" )
						  {
						      dataValue.period = isoPeriod;
							  dataValue.dataElement = dataElementsMapping[k].id;
							  dataValue.categoryOptionCombo = dataElementsMapping[k].categorycombo;
							  dataValue.orgUnit = finalOu[j].id;
							  dataValue.value = apiResponse.data[i].positive_trunat_cbnat_govt;
							  dataValues.push(dataValue);
						  }
						  else if(dataElementsMapping[k].name === "positive_trunat_cbnat_private" )
						  {
							  dataValue.period = isoPeriod;
							  dataValue.dataElement = dataElementsMapping[k].id;
							  dataValue.categoryOptionCombo = dataElementsMapping[k].categorycombo;
							  dataValue.orgUnit = finalOu[j].id;
							  dataValue.value = apiResponse.data[i].positive_trunat_cbnat_private;
							  dataValues.push(dataValue);
						  }	
					  }
										
					}
				
				}
				else{
					console.log( j + " -- " + finalOu[j].name + "  code -- " + finalOu[j].code + " Api Response --  " + apiResponse.sys_message + "  data -- " + apiResponse.data  );
				
				}

				//console.log( apiResponse);


			},
			error: function (apiResponse)
			{
				console.log( "Error" );
				//unLockScreen();
			}
		});

		
	}
	
        var dataValueSet = {};
        dataValueSet.dataValues = dataValues;
		
		console.log(" final dataValueSet : " + JSON.stringify(dataValueSet) );
		console.log(" final dataValueSet size: " + dataValueSet.dataValues.length );
		
		
        importData( dataValueSet );

        $('#loader').hide();

  }

function loadOrgUnits() {
    $.ajax({
        url: "../api/organisationUnits.json?fields=id,name,code,level,attributeValues[attribute[id,name,code],value]&filter=level:eq:3&sortOrder=ASC&paging=false",
        dataType: "json",
        async: false,
        success: function (orgUnitResponse) {
            for (var i = 0; i < orgUnitResponse.organisationUnits.length; i++) {
				finalOu.push({
					'id': orgUnitResponse.organisationUnits[i].id,
					'name': orgUnitResponse.organisationUnits[i].name,
					'code': orgUnitResponse.organisationUnits[i].code
				});
				orgUnitMap[orgUnitResponse.organisationUnits[i].code] = orgUnitResponse.organisationUnits[i].id;
            }
        },
        error: function (err) {
            console.log("org error" + JSON.stringify(err));
        }
    });
}

var importData = function (dataValueSet) {
    //var url = "../api/dataValueSets";

    //var header = { 'Accept': 'application/json', 'Content-Type': 'application/json' };
    var dataJSON = JSON.stringify(dataValueSet);
    /*
    var promise = $http({ method: 'post', url: url, headers: header, data: dataJSON })
            .success(function (response) {
                console.log("response : " + response);
            })
            .error(function (response) {
                console.log("response : " + response);
                console.log("Internal Error : " + response.description);
            });
    return promise;
    */

    if(dataValueSet.dataValues.length != 0){

        $.ajax({
            async: false,
            type: "POST",
            dataType: "json",
            contentType: "application/json",
            url: '../api/dataValueSets/',
            data: dataJSON,
            success: function (response) {
                console.log("response : " + response);
                console.log("response : " + response.conflicts);

                impCount = response.importCount.imported;
                upCount = response.importCount.updated;
                igCount = response.importCount.ignored;
                conflictsDetails   = response.conflicts;

                // dataSet complete registration
				/*
                if ( response.importCount.updated > 0 || response.importCount.imported > 0) {
                    for (var i = 0; i < regOrgUnitList.length; i++) {
                        for (var j = 0; j < regPeriodList.length; j++) {
                            cdsr.completeDataSetRegistrations.push({
                                'dataSet': dataSetUid,
                                'period': regPeriodList[j],
                                'organisationUnit': regOrgUnitList[i]
                                // 'multiOu': false
                            });
                            $.ajax({
                                url: '../api/completeDataSetRegistrations',
                                data: JSON.stringify(cdsr),
                                contentType: "application/json; charset=utf-8",
                                dataType: 'json',
                                type: 'POST',
                                success: function (dataSetRegResponse) {
                                    dataSetCompleteRegistration = "Registration Complete";
                                    //console.log("Registration Complete");
                                },
                                error: function ( dataSetRegResponse) {
                                    console.log("Error in Registration Complete");
                                    dataSetCompleteRegistration = "IGNORED";
                                }
                            });
                            //console.log(cdsr);
                        }
                    }
                }
                else {
                    dataSetCompleteRegistration = "IGNORED";
                }
				*/
				
            },
            error: function (response) {
                console.log("Error in post");
            }
        });
    }

    console.log("conflicts : " + conflictsDetails );
    console.log("importCount : " + impCount + " updateCount : " + upCount + " ignoreCount : " + igCount );

    console.log("dataSetCompleteRegistration : " + dataSetCompleteRegistration );

    if( conflictsDetails === undefined )
    {
        conflictsDetails = "No Conflicts";
    }
    if( dataSetCompleteRegistration === "" )
    {
        dataSetCompleteRegistration = "Registration Complete";
    }
    //unLockScreen();
    var newLine = "\r\n";
    var msg = "Data Imported Successfully With .";
    msg += newLine;
    msg += "Import Count - " + impCount + newLine + "Update Count " + upCount;
    msg += newLine + "Ingore Count " + igCount + newLine ;
    msg += "Conflicts Details - " + conflictsDetails ;
    //msg+= newLine;
    //alert(msg);
    var resultMsg1 = msg;
    var importMsg1 = resultMsg1.bold();

    document.getElementById('importButton').style.display = 'block';
    document.getElementById("Import").disabled = false;
    document.getElementById('resultDiv').style.display = 'block';
    //document.getElementById("importMsg").innerHTML = msg;

    document.getElementById("importMsg").innerHTML = "";
    document.getElementById("importMsg").innerHTML += "Data Imported Successfully With .";
    document.getElementById("importMsg").innerHTML += "<br>";
    document.getElementById("importMsg").innerHTML += "Import Count - " + impCount;
    document.getElementById("importMsg").innerHTML += "<br>";
    document.getElementById("importMsg").innerHTML += "Update Count - " + upCount;
    document.getElementById("importMsg").innerHTML += "<br>";
    document.getElementById("importMsg").innerHTML += "Ingore Count - " + igCount;
    document.getElementById("importMsg").innerHTML += "<br>";
    document.getElementById("importMsg").innerHTML += "Conflicts Details - " + JSON.stringify(conflictsDetails);
    document.getElementById("importMsg").innerHTML += "<br>";
    //document.getElementById("importMsg").innerHTML += "DataSet Registrations Complete - " + dataSetCompleteRegistration;
    document.getElementById("importMsg").innerHTML += "<br>";
    //document.getElementById("importMsg").innerHTML += "dataValueSet - " + JSON.stringify(dataValueSet)  ;

    //unLockScreen();
    //hideLoader();
};

// Defining function to get unique values from an array
function getUnique(array){
    var uniqueArray = [];

    // Loop through array values
    for(i=0; i < array.length; i++){
        if(uniqueArray.indexOf(array[i]) === -1) {
            uniqueArray.push(array[i]);
        }
    }
    return uniqueArray;
}

</script>
</html>